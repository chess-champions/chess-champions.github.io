import{g as J,R as P,u as E,j as r,B as g,a as k,r as d,L as Z,T as y,b as ee,c as ne,d as oe,G as $}from"./index-jOmqNek7.js";import{M as te,a as re,S as se,K as ie,P as ce,V as ae,b as le}from"./swiper-react-CstruTyQ.js";import{u as A,C as ue,G as de,a as pe}from"./useNavigationService-BJtaDnOx.js";import{u as R,C as fe,G as he,a as me,S as xe,b as ge,E as ye,c as ve,Y as C,D as Te,d as D,e as je,f as Ee,g as Se,h as be,L as _e}from"./ChessDataService-ausuiIYk.js";import{L as Ce}from"./Link-DatgZRKC.js";var N={exports:{}},I,B;function Pe(){if(B)return I;B=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return I=e,I}var M,W;function Re(){if(W)return M;W=1;var e=Pe();function t(){}function i(){}return i.resetWarningCache=t,M=function(){function n(p,l,v,h,T,f){if(f!==e){var j=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw j.name="Invariant Violation",j}}n.isRequired=n;function o(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:o,element:n,elementType:n,instanceOf:o,node:n,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:i,resetWarningCache:t};return a.PropTypes=a,a},M}var z;function we(){return z||(z=1,N.exports=Re()()),N.exports}var $e=we();const b=J($e),ke=({category:e,setCategory:t})=>{const i=R(),{t:n}=E();return r.jsx(g,{display:"flex",flexDirection:"column",flexGrow:1,children:fe.map(o=>r.jsx(k,{variant:o===e?"contained":"text",color:i,onClick:()=>t(o),children:n(`category_enum_short.${o}`)},o))})},Ge=P.memo(ke),Le=({game:e,setGame:t})=>{const i=R(),{t:n}=E();return r.jsx(g,{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:{xs:0,md:1},children:he.map(o=>r.jsx(k,{variant:o===e?"contained":"text",color:i,onClick:()=>t(o),children:n(`game_enum_short.${o}`)},o))})},Fe=P.memo(Le),De=({gender:e,setGender:t})=>{const i=R(),{t:n}=E();return r.jsx(g,{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:{xs:0,md:1},children:me.map(o=>r.jsx(k,{variant:o===e?"contained":"text",color:i,onClick:()=>t(o),children:n(`gender_enum_short.${o}`)},o))})},Ne=P.memo(De),Ie=({year:e,category:t,game:i,gender:n})=>{const{t:o}=E(),{getTournamentUrl:a}=A(),p=d.useMemo(()=>o(`gender_category.${n}.${t}`),[n,t,o]),l=d.useMemo(()=>{const T=o(`game_enum.${i}`);return p?`${e} ${T} - ${p}`:`${e} ${T}`},[e,i,p,o]),v=d.useMemo(()=>o("description",{game:o(`game_enum2.${i}`),gender_category:o(`gender_category_full.${n}.${t}`),year:e}),[e,t,i,n,o]),h=d.useMemo(()=>a(e,t,i,n,!1),[e,t,i,n]);return r.jsx(xe,{title:l,description:v,url:h})},Me=({result:e})=>{const{t,i18n:i}=E(),{getPlayerUrl:n}=A(),o=R(),a=(i.resolvedLanguage=="uk"?e.name_uk:e.name_en)||e.name_uk||e.name_en;return r.jsx(Z,{to:n(e.id),style:{textDecoration:"none",color:"inherit"},children:r.jsxs(g,{padding:2,gap:{xs:1,md:2},display:"flex",border:"1px solid #ddd",boxShadow:"0px 4px 6px rgba(63, 81, 181, 0.3)",bgcolor:e.rank<=3?"white":"",sx:{cursor:"pointer"},children:[r.jsx(g,{children:r.jsxs(y,{variant:"body1",children:[e.rank,"."]})}),r.jsxs(g,{flexGrow:1,children:[r.jsx(y,{variant:"body1",children:a}),e.club&&r.jsx(y,{variant:"body2",color:"textSecondary",paddingLeft:1,children:e.club}),e.coach1&&r.jsx(y,{variant:"body2",color:"textSecondary",paddingLeft:2,children:e.coach1}),e.coach2&&r.jsx(y,{variant:"body2",color:"textSecondary",paddingLeft:3,children:e.coach2}),e.notes&&r.jsx(y,{variant:"body2",color:"textSecondary",paddingLeft:1,children:e.notes})]}),r.jsx(g,{children:e.fed&&r.jsx(y,{variant:"body2",color:o,children:t(`federation_enum_short.${e.fed}`)})})]})})},Oe=({tournament:e})=>{var o;const{t,i18n:i}=E(),n=r.jsx(y,{component:"h3",variant:"body2",color:"textSecondary",align:"center",sx:e.id&&e.id>=0?{"&:hover":{textDecoration:"underline"}}:{},children:[e.type?t(`type_enum.${e.type}`):null,i.resolvedLanguage==="uk"?e.location_uk:e.location_en,e.date||null].filter(Boolean).join(", ")});return r.jsxs(g,{display:"flex",flexDirection:"column",gap:1,children:[e.id&&e.id>=0?r.jsx(Ce,{href:`https://chess-results.com/tnr${e.id}.aspx?art=1`,target:"_blank",rel:"noopener",style:{textDecoration:"none",color:"inherit"},children:n}):n,(o=e.results)==null?void 0:o.map((a,p)=>r.jsx(Me,{result:a},`${e.id}_${p}`))]})},Ae=({year:e,category:t,game:i,gender:n})=>{const{data:o,isLoading:a,error:p}=ge({queryKey:["tournaments",{year:e,category:t,game:i,gender:n}],queryFn:async()=>await ve.getTournaments(e,t,i,n)});return r.jsxs(g,{display:"flex",flexDirection:"column",flexGrow:1,marginBottom:4,sx:{overflow:"auto",height:"100%"},children:[a&&r.jsx(ee,{}),p&&r.jsx(ye,{message:p.message}),!a&&!p&&o&&o.map((l,v)=>r.jsx(Oe,{tournament:l},`${e}_${v}`))]})};function _(e){if(typeof window>"u")return e;const t=d.useRef(null);return d.useLayoutEffect(()=>{t.current=e}),d.useCallback((...i)=>{var n;(n=t.current)===null||n===void 0||n.call(t,...i)},[])}const H={};function Ye(e,t){H[e]||(H[e]=!0,console.error("[material-ui-popup-state] WARNING",t))}const Ue={isOpen:!1,setAnchorElUsed:!1,anchorEl:void 0,anchorPosition:void 0,hovered:!1,focused:!1,_openEventType:null,_childPopupState:null,_deferNextOpen:!1,_deferNextClose:!1},V=ne,qe="useId"in V?()=>V.useId():()=>{};function Be({parentPopupState:e,popupId:t=qe(),variant:i,disableAutoFocus:n}){const o=d.useRef(!0);d.useEffect(()=>(o.current=!0,()=>{o.current=!1}),[]);const[a,p]=d.useState(Ue),l=d.useCallback(c=>{o.current&&p(c)},[]),v=d.useCallback(c=>l(s=>({...s,setAnchorElUsed:!0,anchorEl:c??void 0})),[]),h=_(c=>(a.isOpen?j(c):T(c),a)),T=_(c=>{const s=c instanceof Element?void 0:c,u=c instanceof Element?c:(c==null?void 0:c.currentTarget)instanceof Element?c.currentTarget:void 0;if((s==null?void 0:s.type)==="touchstart"){l(m=>({...m,_deferNextOpen:!0}));return}const Y=s==null?void 0:s.clientX,U=s==null?void 0:s.clientY,Q=typeof Y=="number"&&typeof U=="number"?{left:Y,top:U}:void 0,q=m=>{if(!c&&!m.setAnchorElUsed&&i!=="dialog"&&Ye("missingEventOrAnchorEl","eventOrAnchorEl should be defined if setAnchorEl is not used"),e){if(!e.isOpen)return m;setTimeout(()=>e._setChildPopupState(S))}const F={...m,isOpen:!0,anchorPosition:Q,hovered:(s==null?void 0:s.type)==="mouseover"||m.hovered,focused:(s==null?void 0:s.type)==="focus"||m.focused,_openEventType:s==null?void 0:s.type};return m.setAnchorElUsed||(s!=null&&s.currentTarget?F.anchorEl=s==null?void 0:s.currentTarget:u&&(F.anchorEl=u)),F};l(m=>m._deferNextOpen?(setTimeout(()=>l(q),0),{...m,_deferNextOpen:!1}):q(m))}),f=c=>{const{_childPopupState:s}=c;return setTimeout(()=>{s==null||s.close(),e==null||e._setChildPopupState(null)}),{...c,isOpen:!1,hovered:!1,focused:!1}},j=_(c=>{const s=c instanceof Element?void 0:c;if((s==null?void 0:s.type)==="touchstart"){l(u=>({...u,_deferNextClose:!0}));return}l(u=>u._deferNextClose?(setTimeout(()=>l(f),0),{...u,_deferNextClose:!1}):f(u))}),x=d.useCallback((c,s)=>{c?T(s):j(s)},[]),G=_(c=>{const{relatedTarget:s}=c;l(u=>u.hovered&&!(s instanceof Element&&O(s,S))?u.focused?{...u,hovered:!1}:f(u):u)}),w=_(c=>{if(!c)return;const{relatedTarget:s}=c;l(u=>u.focused&&!(s instanceof Element&&O(s,S))?u.hovered?{...u,focused:!1}:f(u):u)}),L=d.useCallback(c=>l(s=>({...s,_childPopupState:c})),[]),S={...a,setAnchorEl:v,popupId:t??void 0,variant:i,open:T,close:j,toggle:h,setOpen:x,onBlur:w,onMouseLeave:G,disableAutoFocus:n??!!(a.hovered||a.focused),_setChildPopupState:L};return S}function We({isOpen:e,popupId:t,variant:i}){return{...i==="popover"?{"aria-haspopup":!0,"aria-controls":e?t:void 0}:i==="popper"?{"aria-describedby":e?t:void 0}:void 0}}function ze(e){return{...We(e),onClick:e.open,onTouchStart:e.open}}function He({isOpen:e,anchorEl:t,anchorPosition:i,close:n,popupId:o,onMouseLeave:a,disableAutoFocus:p,_openEventType:l}){return{id:o,anchorEl:t,anchorPosition:i,anchorReference:l==="contextmenu"?"anchorPosition":"anchorEl",open:e,onClose:n,onMouseLeave:a,...p&&{autoFocus:!1,disableAutoFocusItem:!0,disableAutoFocus:!0,disableEnforceFocus:!0,disableRestoreFocus:!0}}}function Ve(e,{popupId:t}){if(!t)return null;const i=typeof e.getRootNode=="function"?e.getRootNode():document;return typeof i.getElementById=="function"?i.getElementById(t):null}function O(e,t){const{anchorEl:i,_childPopupState:n}=t;return K(i,e)||K(Ve(e,t),e)||n!=null&&O(e,n)}function K(e,t){if(!e)return!1;for(;t;){if(t===e)return!0;t=t.parentElement}return!1}function X({children:e,popupId:t,variant:i,parentPopupState:n,disableAutoFocus:o}){const a=Be({popupId:t,variant:i,parentPopupState:n,disableAutoFocus:o}),p=e(a);return p??null}X.propTypes={children:b.func.isRequired,popupId:b.string,variant:b.oneOf(["popover","popper"]).isRequired,parentPopupState:b.object,disableAutoFocus:b.bool};const Ke=({year:e,setYear:t})=>{const i=R();return r.jsx(X,{variant:"popover",popupId:"year-menu",children:n=>r.jsxs(P.Fragment,{children:[r.jsx(k,{variant:"contained",color:i,...ze(n),children:e}),r.jsx(te,{...He(n),children:C.map(o=>r.jsx(re,{selected:o===e,onClick:()=>{n.close(),setTimeout(()=>{t(o)},50)},children:o},o))})]})})},Xe=P.memo(Ke),on=()=>{const[e]=oe(),{navigateToTournament:t}=A(),{t:i}=E(),n=parseInt(e.get("year")||"")||Te,o=D.stringToEnum(e.get("category"),ue)||je,a=D.stringToEnum(e.get("game"),de)||Ee,p=D.stringToEnum(e.get("gender"),pe)||Se,[l,v]=d.useState(n),[h,T]=d.useState(o),[f,j]=d.useState(a),[x,G]=d.useState(p),w=d.useRef(null),L=d.useMemo(()=>i(`gender_category.${x}.${h}`),[h,x,i]);d.useEffect(()=>{(n!=l||o!=h||a!=f||p!=x)&&t(l,h,f,x,!0)},[l,h,f,x]);const S=d.useCallback(c=>{var s,u;(u=(s=w.current)==null?void 0:s.swiper)==null||u.slideToLoop(C.indexOf(c))},[]);return r.jsxs(r.Fragment,{children:[r.jsx(Ie,{year:l,category:h,game:f,gender:x}),r.jsx(be,{gender:x,children:r.jsxs($,{container:!0,spacing:{xs:1,md:2},padding:2,overflow:"hidden",height:"100%",children:[r.jsxs($,{container:!0,direction:"column",gap:{xs:1,md:2},size:"auto",overflow:"auto",children:[r.jsx(Xe,{year:l,setYear:S}),r.jsx(Ge,{category:h,setCategory:T}),r.jsx(_e,{})]}),r.jsxs($,{container:!0,direction:"column",size:"grow",overflow:"hidden",height:"100%",children:[r.jsx(Ne,{gender:x,setGender:G}),r.jsx($,{size:"grow",overflow:"hidden",height:"100%",children:r.jsx(se,{ref:w,direction:"horizontal",initialSlide:C.indexOf(l),loop:!0,spaceBetween:10,slidesPerView:1,style:{width:"100%",height:"100%"},pagination:{clickable:!1},keyboard:{enabled:!0},onSlideChange:c=>{v(C[c.realIndex])},virtual:{enabled:!0},modules:[ie,ce,ae],children:C.map(c=>r.jsx(le,{"aria-hidden":l!==c,children:r.jsxs(g,{display:"flex",flexDirection:"column",gap:{xs:1,md:2},overflow:"hidden",height:"100%",children:[r.jsxs(g,{children:[r.jsxs(y,{variant:"h5",component:"h1",align:"center",children:[i(`game_enum.${f}`)," ",c]}),r.jsx(y,{variant:"h6",component:"h2",align:"center",color:"textSecondary",children:L})]}),r.jsx(Ae,{year:c,category:h,game:f,gender:x})]})},c))})}),r.jsx(Fe,{game:f,setGame:j})]})]})})]})};export{on as default};
