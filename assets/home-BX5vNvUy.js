import{j as n,B as l,d as S,e as _,f as L,T as m,L as M,P as R,g as A,M as O,h as B,i as I,G as w,D as y}from"./mui-CXhE_iE7.js";import{r as x,a as f,L as D}from"./react-Bs57X6Ch.js";import{a as v,c as Y,f as g,C as F,G as P,g as U,S as H,h as T,i as k,j as C,L as z,E as V,Y as $,k as K,l as q,m as N,e as b,n as Q,o as W,q as J,p as X,r as Z}from"./shared-FEzA3Crr.js";import{u as p,t as ee}from"./localization-BTb5j_W4.js";import{S as ne,K as se,P as te,V as oe,a as ie}from"./swiper-BWAETjh8.js";import{u as re}from"./query-DeXAFL7x.js";import"./analytics-HyNrjKFN.js";import"./utils-BT3gc4jm.js";const ae=({year:e,category:i,game:t,gender:o})=>{const{t:s}=p(),{getTournamentUrl:r}=v(),a=x.useMemo(()=>s(`gender_category.${o}.${i}`),[o,i,s]),j=x.useMemo(()=>{const c=s(`game_enum.${t}`);return a?`${e} ${c} - ${a}`:`${e} ${c}`},[e,t,a,s]),u=x.useMemo(()=>s("description",{game:s(`game_enum2.${t}`),gender_category:s(`gender_category_full.${o}.${i}`),year:e}),[e,i,t,o,s]),d=x.useMemo(()=>r(e,i,t,o,!1),[e,i,t,o]);return n.jsx(Y,{title:j,description:u,url:d})},ce=({category:e,setCategory:i,direction:t="column"})=>{const o=g(),{t:s}=p();return n.jsx(l,{display:"flex",flexDirection:t,children:F.map(r=>n.jsx(S,{variant:r===e?"contained":"text",color:o,onClick:()=>i(r),children:s(`category_enum_short.${r}`)},r))})},le=f.memo(ce),de=({game:e,setGame:i,direction:t="column"})=>{const o=g(),{t:s}=p();return n.jsx(l,{display:"flex",flexDirection:t,children:P.map(r=>n.jsx(S,{variant:r===e?"contained":"text",color:o,sx:{textTransform:"none"},onClick:()=>i(r),children:s(`game_enum_short_short.${r}`)},r))})},xe=f.memo(de),me=({gender:e,setGender:i,direction:t="column"})=>{const o=g(),{t:s}=p();return n.jsx(l,{display:"flex",flexDirection:t,justifyContent:"center",alignItems:"center",gap:{xs:0,md:1},children:U.map(r=>n.jsx(S,{variant:r===e?"contained":"text",color:o,onClick:()=>i(r),children:s(`gender_enum_short.${r}`)},r))})},ue=f.memo(me),he=({year:e})=>{const i=g(),{t}=p(),{getStatsUrl:o}=v();return n.jsx(_,{title:t("stats",{year:e}),children:n.jsx(S,{component:D,to:o(e,!0),variant:"outlined",color:i,sx:{width:40,height:40,minWidth:40,padding:0,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",textTransform:"none"},children:n.jsx(L,{fontSize:"small"})})})},pe=f.memo(he),je="/",fe={async getTournaments(e,i,t,o){const s=H.encode(`${e}_${i}_${t}_${o}`),r=await fetch(`${je}api/tournaments/${s}.json?v=5ef69bc`);if(!r.ok)throw new Error(`Failed to get tournament (year:${e}, category: ${T[i]}, game: ${k[t]}, gender: ${C[o]}) data`);return await r.json()}},ge=({result:e})=>{const{t:i,i18n:t}=p(),{getPlayerUrl:o}=v(),s=g(),r=(t.resolvedLanguage=="uk"?e.name_uk:e.name_en)||e.name_uk||e.name_en,a=[e.club,e.coach1,e.coach2,e.coach3].filter(Boolean).join(", ")||e.notes;return n.jsx(D,{to:o(e.id),style:{textDecoration:"none",color:"inherit"},children:n.jsxs(l,{padding:2,gap:{xs:1,md:2},display:"flex",border:"1px solid #ddd",boxShadow:"0px 4px 6px rgba(63, 81, 181, 0.3)",bgcolor:e.rank<=3?"white":"",sx:{cursor:"pointer"},children:[n.jsx(l,{children:n.jsxs(m,{variant:"body1",children:[e.rank,"."]})}),n.jsxs(l,{flexGrow:1,children:[n.jsx(m,{variant:"body1",children:r}),a&&n.jsx(m,{variant:"body2",color:"textSecondary",paddingLeft:1,children:a})]}),n.jsxs(l,{children:[e.fed&&n.jsx(m,{variant:"body2",color:s,textAlign:"right",children:i(`federation_enum_short.${e.fed}`)}),e.points!=null&&n.jsx(m,{variant:"body2",color:"textSecondary",textAlign:"right",children:e.points})]})]})})},$e=({tournament:e})=>{const{t:i,i18n:t}=p(),o=n.jsx(m,{component:"h3",variant:"body2",color:"textSecondary",align:"center",sx:e.id&&e.id>=0?{"&:hover":{textDecoration:"underline"}}:{},children:[i(`type_enum.${e.type}`),t.resolvedLanguage==="uk"?e.location_uk:e.location_en,e.date||null].filter(Boolean).join(", ")});return n.jsxs(l,{display:"flex",flexDirection:"column",gap:1,children:[e.id&&e.id>=0?n.jsx(M,{href:`https://chess-results.com/tnr${e.id}.aspx?art=1`,target:"_blank",rel:"noopener",style:{textDecoration:"none",color:"inherit"},children:o}):o,((e.round??0)>0&&(e.round??0)<(e.rounds||1/0)||e.missedResults)&&n.jsxs(m,{component:"h4",variant:"body2",color:"textSecondary",align:"center",children:[i("rankAfterRound",{round:e.round??0}),e.missedResults?` (${i("missingResults",{count:e.missedResults})})`:""]}),e.results?.map((s,r)=>n.jsx(ge,{result:s},`${e.id}_${r}`))]})},Se=({year:e,category:i,game:t,gender:o})=>{const{data:s,isLoading:r,error:a}=re({queryKey:["tournaments",{year:e,category:i,game:t,gender:o}],queryFn:async()=>await fe.getTournaments(e,i,t,o)});return n.jsxs(l,{display:"flex",flexDirection:"column",gap:{xs:1,md:2},flexGrow:1,marginBottom:4,sx:{overflow:"auto",height:"100%"},children:[r&&n.jsx(z,{}),a&&n.jsx(V,{message:a.message}),!r&&!a&&s&&s.length===0&&n.jsx(m,{variant:"body1",color:"textSecondary",align:"center",children:ee("noData")}),!r&&!a&&s&&s.length>0&&s.map((j,u)=>n.jsx($e,{tournament:j},`${e}_${u}`))]})},we=({year:e,setYear:i})=>{const t=g();return n.jsx(R,{variant:"popover",popupId:"year-menu",children:o=>n.jsxs(f.Fragment,{children:[n.jsx(S,{variant:"contained",color:t,...A(o),children:e}),n.jsx(O,{...B(o),children:$.map(s=>n.jsx(I,{selected:s===e,onClick:()=>{o.close(),setTimeout(()=>{i(s)},50)},children:s},s))})]})})},ye=f.memo(we),be=({year:e,setYear:i,category:t,setCategory:o,game:s,setGame:r,gender:a,setGender:j})=>{const{t:u}=p(),d=x.useMemo(()=>u(`gender_category.${a}.${t}`),[t,a,u]),c=x.useRef(null),G=x.useCallback(h=>c.current?.swiper?.slideToLoop($.indexOf(h)),[]);return n.jsx(K,{gender:a,children:n.jsxs(w,{container:!0,spacing:{xs:1,md:2},padding:2,minHeight:"100vh",children:[n.jsxs(w,{container:!0,direction:"column",gap:{xs:1,md:2},size:"auto",children:[n.jsx(ye,{year:e,setYear:G}),n.jsx(y,{}),n.jsx(le,{category:t,setCategory:o}),n.jsx(y,{}),n.jsx(xe,{game:s,setGame:r}),n.jsx(y,{}),n.jsx(l,{display:"flex",flexDirection:"column",flexGrow:1}),n.jsx(l,{display:"flex",alignItems:"center",justifyContent:"center",children:n.jsx(pe,{year:e})}),n.jsx(y,{}),n.jsx(q,{})]}),n.jsxs(w,{container:!0,direction:"column",size:"grow",children:[n.jsx(ue,{gender:a,setGender:j,direction:"row"}),n.jsx(w,{size:"grow",children:n.jsx(ne,{ref:c,direction:"horizontal",initialSlide:$.indexOf(e),loop:!0,spaceBetween:10,slidesPerView:1,style:{width:"100%",height:"100%"},pagination:{clickable:!1},keyboard:{enabled:!0},onSlideChange:h=>{const E=$[h.realIndex];E!==e&&i(E)},virtual:{enabled:!0},modules:[se,te,oe],children:$.map(h=>n.jsx(ie,{"aria-hidden":e!==h,children:n.jsxs(l,{display:"flex",flexDirection:"column",gap:{xs:1,md:2},children:[n.jsxs(l,{children:[n.jsxs(m,{variant:"h5",component:"h1",align:"center",children:[u(`game_enum.${s}`)," ",h]}),n.jsx(m,{variant:"h6",component:"h2",align:"center",color:"textSecondary",children:d})]}),n.jsx(Se,{year:h,category:t,game:s,gender:a})]})},h))})})]})]})})},ve=f.memo(be),Me=()=>{const[{year:e,category:i,game:t,gender:o},s]=N({year:X.withDefault(Z).withOptions({clearOnDefault:!1}),category:b(T).withDefault(J).withOptions({clearOnDefault:!1}),game:b(k).withDefault(W).withOptions({clearOnDefault:!1}),gender:b(C).withDefault(Q).withOptions({clearOnDefault:!1})}),r=x.useCallback(d=>s(c=>({...c,year:d})),[s]),a=x.useCallback(d=>s(c=>({...c,category:d})),[s]),j=x.useCallback(d=>s(c=>({...c,game:d})),[s]),u=x.useCallback(d=>s(c=>({...c,gender:d})),[s]);return n.jsxs(n.Fragment,{children:[n.jsx(ae,{year:e,category:i,game:t,gender:o}),n.jsx(ve,{year:e,setYear:r,category:i,setCategory:a,game:t,setGame:j,gender:o,setGender:u})]})};export{Me as HomePage};
