import{j as n,B as x,T as y,D as G,k as K,l as Y,m as M,n as A,o as u,p as s,q as W,I as q,K as R,s as H,C as I,t as N,d as O}from"./mui-CXhE_iE7.js";import{a as _,L as T,r as S}from"./react-Bs57X6Ch.js";import{S as D,a as z,T as Q,L as V,E as J,R as X}from"./shared-D-I0C6uU.js";import{u as Z}from"./query-DeXAFL7x.js";import{u as P}from"./localization-BTb5j_W4.js";var i=(a=>(a[a.Year=0]="Year",a[a.Federation=1]="Federation",a[a.Club=2]="Club",a[a.Coach=3]="Coach",a[a.Player=4]="Player",a))(i||{});const f=({national:a,international:h})=>n.jsxs(x,{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:{xs:"column",sm:"row"},children:[n.jsx(y,{fontSize:"0.85rem",fontWeight:"500",children:a}),h>0&&n.jsxs(n.Fragment,{children:[n.jsx(y,{fontSize:"0.85rem",fontWeight:"500",display:{xs:"none",sm:"inline"},children:" + "}),n.jsx(y,{fontSize:"0.85rem",fontWeight:"500",color:"primary",children:h})]})]}),F="/",k={[i.Year]:"years",[i.Federation]:"feds",[i.Club]:"clubs",[i.Coach]:"coaches",[i.Player]:"players"},nn={async get(a,h,c,t){a>c&&([a,c]=[c,a],[h,t]=[t,h]);const g=k[a],m=D.encode(h.toString()),j=k[c],l=D.encode(t.toString()),o=`${F}api/results/${g}/${m}/${j}/${l}.json?v=7a13394`,p=await fetch(o);if(!p.ok)throw new Error(`Failed to get results (${i[a]}=${h}, ${i[c]}=${t})`);return await p.json()}},en=({data:a,showDetails:h})=>{const{getTournamentUrl:c,getPlayerUrl:t}=z(),{t:g,i18n:m}=P(),j=(l,o,p,b,C)=>{const v=g(`type_enum_short.${l}`),w=g(`game_enum_short.${b}`),$=g(`gender_category.${C}.${p}`);return $?`${v} ${o} ${w} - ${$}`:`${v} ${o} ${w}`};return[...new Set(a.map(l=>l.rank))].map(l=>n.jsxs(x,{display:"flex",flexDirection:"row",padding:2,gap:2,border:"1px solid #ddd",boxShadow:"0px 4px 6px rgba(63, 81, 181, 0.3)",bgcolor:l===1?"#ffffff":l===2?"#fcfcfc":l===3?"#f7f7f7":l===4?"#ededed":l===5?"#e5e5e5":"transparent",children:[n.jsx(x,{children:n.jsxs(y,{variant:"body1",children:[l,"."]})}),n.jsx(x,{flex:1,children:a.filter(o=>o.rank===l).map((o,p,b)=>n.jsxs(_.Fragment,{children:[n.jsxs(x,{display:"flex",flexDirection:{xs:"column",md:"row"},gap:1,alignItems:{xs:"flex-start",md:"center"},sx:{"&:hover":{backgroundColor:"#f9f9f9"},borderRadius:"4px"},children:[n.jsx(T,{to:c(o.year,o.category,o.game,o.gender),style:{textDecoration:"none",color:"inherit",flex:1},children:n.jsx(y,{variant:"body1",color:o.type===Q.UC?"textPrimary":"primary",sx:{"&:hover":{textDecoration:"underline"}},children:j(o.type,o.year,o.category,o.game,o.gender)})}),h&&n.jsx(T,{to:t(o.id),style:{textDecoration:"none",color:"inherit"},children:n.jsx(y,{variant:"body2",color:"textSecondary",sx:{"&:hover":{textDecoration:"underline"}},children:(m.resolvedLanguage==="uk"?o.name_uk:o.name_en)||o.name_uk||o.name_en||""})})]}),p<b.length-1&&n.jsx(G,{sx:{my:1}})]},p))})]},l))},an=({filterField:a,filterId:h,subFilterField:c,subFilterId:t})=>{const{data:g,isLoading:m,error:j}=Z({queryKey:["results",{filterField:a,filterId:h,subFilterField:c,subFilterId:t}],queryFn:async()=>await nn.get(a,h,c,t)});return n.jsxs(x,{display:"flex",flexDirection:"column",gap:1,children:[m&&n.jsx(V,{height:"auto"}),j&&n.jsx(J,{message:j.message,height:"auto"}),!m&&!j&&g&&n.jsx(en,{data:g.results,showDetails:a!==i.Player&&c!==i.Player})]})},ln=({filterField:a,filterId:h,groupField:c,results:t})=>{const[g,m]=S.useState(null),[j,l]=S.useState(20),o=t.slice(0,j),p=()=>{l(e=>e+20)},{getFederationUrl:b,getClubUrl:C,getCoachUrl:v,getPlayerUrl:w,getStatsUrl:$}=z(),{t:d,i18n:U}=P(),L=()=>{switch(c){case i.Year:return d("year");case i.Federation:return d("federation");case i.Club:return d("club");case i.Coach:return d("coach");case i.Player:return d("player");default:throw new Error(`Unhandled group field in getGroupTitle: ${c}`)}},E=e=>{switch(c){case i.Year:return $(e);case i.Federation:return b(e);case i.Club:return C(e);case i.Coach:return v(e);case i.Player:return w(e);default:throw new Error(`Unhandled group field in getGroupProfileUrl: ${c}`)}};function B(e){const r=(U.resolvedLanguage==="uk"?e.name_uk:e.name_en)||e.name_uk||e.name_en;return r||(c===i.Year?e.id.toString():"")}return n.jsx(K,{component:Y,children:n.jsxs(M,{stickyHeader:!0,sx:{"& th, & td":{padding:{xs:"6px 8px",sm:"6px 10px",md:"6px 12px",lg:"6px 16px"},verticalAlign:"top"}},children:[n.jsx(A,{children:n.jsxs(u,{children:[n.jsx(s,{}),n.jsx(s,{children:n.jsx(y,{children:L()})}),n.jsx(s,{children:n.jsxs(x,{display:"flex",flexDirection:"column",alignItems:"center",children:[n.jsx(x,{sx:{display:{xs:"none",sm:"block"}},children:d("gold")}),n.jsx("img",{alt:d("gold"),width:"16",height:"16",src:"/gold.svg"})]})}),n.jsx(s,{children:n.jsxs(x,{display:"flex",flexDirection:"column",alignItems:"center",children:[n.jsx(x,{sx:{display:{xs:"none",sm:"block"}},children:d("silver")}),n.jsx("img",{alt:d("silver"),width:"16",height:"16",src:"/silver.svg"})]})}),n.jsx(s,{children:n.jsxs(x,{display:"flex",flexDirection:"column",alignItems:"center",children:[n.jsx(x,{sx:{display:{xs:"none",sm:"block"}},children:d("bronze")}),n.jsx("img",{alt:d("bronze"),width:"16",height:"16",src:"/bronze.svg"})]})}),n.jsx(s,{children:n.jsxs(x,{display:"flex",flexDirection:"column",alignItems:"center",children:[n.jsx(x,{sx:{display:{xs:"none",sm:"block"}},children:d("total")}),n.jsx("img",{alt:d("total"),width:"16",height:"16",src:"/total.svg"})]})})]})}),n.jsx(W,{children:o?.map(e=>n.jsxs(_.Fragment,{children:[n.jsxs(u,{sx:{"& td":{borderBottom:"none"}},onClick:()=>m(e.id===g?null:e.id),children:[n.jsx(s,{children:n.jsxs(x,{display:"flex",flexDirection:"row",alignItems:"center",gap:2,children:[n.jsx(q,{sx:{padding:"0px"},size:"small",onClick:r=>{r.stopPropagation(),m(e.id===g?null:e.id)},children:e.id===g?n.jsx(R,{}):n.jsx(H,{})}),e.rank&&n.jsxs(y,{children:[e.rank,"."]})]})}),n.jsx(s,{children:e.id!=0?n.jsx(X,{to:E(e.id),children:B(e)}):d("notSpecified")}),n.jsx(s,{children:n.jsx(f,{national:e.national.gold,international:e.international.gold})}),n.jsx(s,{children:n.jsx(f,{national:e.national.silver,international:e.international.silver})}),n.jsx(s,{children:n.jsx(f,{national:e.national.bronze,international:e.international.bronze})}),n.jsx(s,{align:"center",children:e.national.gold+e.national.silver+e.national.bronze+e.international.gold+e.international.silver+e.international.bronze})]}),n.jsx(u,{children:n.jsx(s,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:n.jsx(I,{in:e.id===g,timeout:"auto",unmountOnExit:!0,children:n.jsx(x,{marginTop:1,marginBottom:2,children:n.jsx(an,{filterField:a,filterId:h,subFilterField:c,subFilterId:e.id})})})})})]},`${a}_${e.id}`))}),n.jsxs(N,{children:[j<t.length&&n.jsx(u,{children:n.jsx(s,{colSpan:6,align:"center",sx:{padding:2},children:n.jsx(O,{variant:"outlined",onClick:p,children:d("load_more")})})}),n.jsxs(u,{children:[n.jsx(s,{colSpan:2,children:n.jsx(y,{fontWeight:"bold",children:d("total")})}),n.jsx(s,{children:n.jsx(f,{national:t.reduce((e,r)=>e+r.national.gold,0),international:t.reduce((e,r)=>e+r.international.gold,0)})}),n.jsx(s,{children:n.jsx(f,{national:t.reduce((e,r)=>e+r.national.silver,0),international:t.reduce((e,r)=>e+r.international.silver,0)})}),n.jsx(s,{children:n.jsx(f,{national:t.reduce((e,r)=>e+r.national.bronze,0),international:t.reduce((e,r)=>e+r.international.bronze,0)})}),n.jsx(s,{children:n.jsx(f,{national:t.reduce((e,r)=>e+r.national.gold+r.national.silver+r.national.bronze,0),international:t.reduce((e,r)=>e+r.international.gold+r.international.silver+r.international.bronze,0)})})]})]})]})})};export{ln as M,i as R};
